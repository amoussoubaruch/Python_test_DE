--1. Montant total des ventes, jour par jourWITH tmp_data AS (SELECT date, prod_price * prod_qty  AS total_priceFROM TRANSACTION;)SELECT date, sum(total_price) AS VENTESGROUP BY DATE ORDER BY DATE --2. par client les ventes meuble et déco réalisées.WITH tmp_data_deco AS (SELECT client_id prod_price * prod_qty  AS total_priceFROM TRANSACTIONWHERE prop_id IN (SELECT product_id FROM PRODUCT_NOMENCLATURE WHERE product_type="DECO");),tmp_data_meuble AS (SELECT client_id prod_price * prod_qty  AS total_priceFROM TRANSACTIONWHERE prop_id IN (SELECT product_id FROM PRODUCT_NOMENCLATURE WHERE product_type="MEUBLE");),sum_deco AS (SELECT client_id, sum(total_price) AS ventes_decoGROUP BY client_id ),sum_meuble AS (SELECT client_id, sum(total_price) AS ventes_meubleGROUP BY client_id )SELECT sum_meuble.client_id, sum_meuble.ventes_meuble,sum_deco.ventes_decoFROM sum_meuble INNER JOIN sum_decoON client_id